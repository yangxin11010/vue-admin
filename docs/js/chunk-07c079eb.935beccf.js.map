{"version":3,"sources":["webpack:///./src/views/system/system.vue","webpack:///./src/views/system/system.vue?f0ea","webpack:///./src/views/system/system.vue?012e","webpack:///./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack:///./src/util/storage/index.ts","webpack:///./src/plugins/mitt/index.ts","webpack:///./src/hooks/use-location.ts","webpack:///./src/hooks/use-page-update.ts","webpack:///./src/util/validata/index.ts"],"names":["class","type","clickHandle","$store","getters","age","page","ref","promise","loginIngo","result","code","value","data","list","item","index","key","title","error","name","setup","promiseRef","store","mystore","dispatch","goods","queryGoods","size","log","e","console","state","render","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","_createClass","Constructor","protoProps","staticProps","prototype","storageType","this","storage","JSON","parse","getItem","setItem","stringify","removeItem","session","sessionStorage","localStorage","emitter","$emit","emit","$on","on","$off","off","options","refValue","isWatch","mitt","deep","locationValue","route","watchUpdate","meta","keepAlive","linkReg","emailReg","checkLink","val","test","checkEmail","isObject","toString","call"],"mappings":"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","file":"js/chunk-07c079eb.935beccf.js","sourcesContent":["<template>\r\n    <div class=\"system\">\r\n        <el-button type=\"primary\" @click=\"clickHandle\">click</el-button>\r\n        <p>{{ $store.getters[\"setting/name\"] }}</p>\r\n        <p>{{ age }}</p>\r\n        <p>{{ page }}</p>\r\n        <Promise ref=\"promiseRef\" :promise=\"loginIngo\">\r\n            <Then v-slot=\"{ result }\">\r\n                <p>code: {{ result.code }}</p>\r\n                <data-list :value=\"result.data.list\" v-slot=\"{ data }\">\r\n                    <p v-for=\"(item, index) in data\" :key=\"index\">{{ item.title }}</p>\r\n                </data-list>\r\n            </Then>\r\n            <Catch v-slot=\"{ error }\">\r\n                {{ error }}\r\n            </Catch>\r\n        </Promise>\r\n    </div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { computed, defineComponent, onMounted, ref } from \"vue\";\r\nimport { usePageUpdate } from \"@/hooks\";\r\nimport { useGlobal } from \"@/plugins/vue-global-store\";\r\nimport $api from \"@/api\";\r\nimport { useStore } from \"@/store\";\r\n\r\nexport default defineComponent({\r\n    name: \"System\",\r\n    setup() {\r\n        onMounted(() => {});\r\n        const page = ref(1),\r\n            promiseRef = ref(),\r\n            store = useStore();\r\n        const mystore = useGlobal();\r\n\r\n        usePageUpdate(() => {});\r\n\r\n        const clickHandle = () => {\r\n            // mystore.commit(\"SET_AGE\", Math.floor(Math.random() * 10));\r\n            store.dispatch(\"setting/SET_NAME\", \"李四\");\r\n            // page.value++;\r\n            // promiseRef.value.axios();\r\n        };\r\n\r\n        const loginIngo = () => {\r\n            return $api.goods.queryGoods({\r\n                page: page.value,\r\n                size: 10,\r\n            });\r\n        };\r\n\r\n        const log = (e: any) => {\r\n            console.log(e);\r\n        };\r\n\r\n        return {\r\n            clickHandle,\r\n            age: computed(() => mystore.state.age),\r\n            loginIngo,\r\n            log,\r\n            page,\r\n            promiseRef,\r\n        };\r\n    },\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>\r\n","\r\nimport { computed, defineComponent, onMounted, ref } from \"vue\";\r\nimport { usePageUpdate } from \"@/hooks\";\r\nimport { useGlobal } from \"@/plugins/vue-global-store\";\r\nimport $api from \"@/api\";\r\nimport { useStore } from \"@/store\";\r\n\r\nexport default defineComponent({\r\n    name: \"System\",\r\n    setup() {\r\n        onMounted(() => {});\r\n        const page = ref(1),\r\n            promiseRef = ref(),\r\n            store = useStore();\r\n        const mystore = useGlobal();\r\n\r\n        usePageUpdate(() => {});\r\n\r\n        const clickHandle = () => {\r\n            // mystore.commit(\"SET_AGE\", Math.floor(Math.random() * 10));\r\n            store.dispatch(\"setting/SET_NAME\", \"李四\");\r\n            // page.value++;\r\n            // promiseRef.value.axios();\r\n        };\r\n\r\n        const loginIngo = () => {\r\n            return $api.goods.queryGoods({\r\n                page: page.value,\r\n                size: 10,\r\n            });\r\n        };\r\n\r\n        const log = (e: any) => {\r\n            console.log(e);\r\n        };\r\n\r\n        return {\r\n            clickHandle,\r\n            age: computed(() => mystore.state.age),\r\n            loginIngo,\r\n            log,\r\n            page,\r\n            promiseRef,\r\n        };\r\n    },\r\n});\r\n","import { render } from \"./system.vue?vue&type=template&id=356b58cc\"\nimport script from \"./system.vue?vue&type=script&lang=ts\"\nexport * from \"./system.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","export interface StorageApi {\r\n    getItem: (key: string) => any;\r\n    setItem: (key: string, value: any) => void;\r\n    removeItem: (key: string) => void;\r\n}\r\nexport type SessionWay = \"session\" | \"location\";\r\n\r\nclass StorageProxy implements StorageApi {\r\n    protected storage: StorageApi;\r\n\r\n    constructor(storageType: StorageApi) {\r\n        this.storage = storageType;\r\n    }\r\n\r\n    public getItem(key: string) {\r\n        return JSON.parse(this.storage.getItem(key));\r\n    }\r\n\r\n    public setItem(key: string, value: any) {\r\n        this.storage.setItem(key, JSON.stringify(value));\r\n    }\r\n\r\n    public removeItem(key: string) {\r\n        this.storage.removeItem(key);\r\n    }\r\n}\r\n\r\nexport const session = new StorageProxy(sessionStorage);\r\nexport const location = new StorageProxy(localStorage);\r\n\r\n/**\r\n * 设置storage\r\n * @param {String} key\r\n * @param {Any}    value\r\n * @param {String} way  \"session\" | \"location\"\r\n * { key, value, way = \"session\" }: StorageOptions\r\n */\r\nexport const setStorage = (key: string, value: any, way: SessionWay = \"session\") => {\r\n    if (key && value) window[way].setItem(key, JSON.stringify(value));\r\n};\r\n\r\n/**\r\n * 获取storage\r\n * @param {String} key\r\n * @param {String} way  \"session\" | \"location\"\r\n * @returns {Any}\r\n */\r\nexport const getStorage = (key: string, way: SessionWay = \"session\") => {\r\n    if (key) return JSON.parse(window[way].getItem(key));\r\n    return null;\r\n};\r\n\r\n/**\r\n * 移除storage\r\n * @param {String} key\r\n * @param {String} way  \"session\" | \"location\"\r\n */\r\nexport const removeStorage = (key: string, way: SessionWay = \"session\") => {\r\n    if (key) window[way].removeItem(key);\r\n};\r\n","//  Event bus\r\nimport mitt from \"mitt\";\r\n\r\nconst emitter = mitt();\r\n\r\nexport default {\r\n    $emit: emitter.emit,\r\n    $on: emitter.on,\r\n    $off: emitter.off,\r\n};\r\n","import { ref, Ref, onBeforeMount, watch } from \"vue\";\r\nimport { location, session } from \"@/util/storage\";\r\nimport mitter from \"@/plugins/mitt\";\r\nimport { isObject } from \"@/util/validata\";\r\n\r\nexport interface UseLocationOptions<T> {\r\n    name: string;\r\n    value: T;\r\n    isWatch?: boolean;\r\n    storage?: \"session\" | \"location\";\r\n}\r\n\r\n/**\r\n * useLocation\r\n * @param options\r\n * @returns\r\n */\r\nexport default <T = any>(options: UseLocationOptions<T>): Ref<T> => {\r\n    const refValue = ref<T>(options.value) as Ref<T>;\r\n\r\n    watch(\r\n        refValue,\r\n        (value) => {\r\n            if (!options.isWatch) {\r\n                mitter.$emit<T>(options.name, value);\r\n                if (options.storage && options.storage === \"session\") {\r\n                    session.setItem(options.name, value);\r\n                } else {\r\n                    location.setItem(options.name, value);\r\n                }\r\n            }\r\n        },\r\n        {\r\n            // deep: typeof options.value === \"object\",\r\n            deep: isObject(options.value),\r\n        }\r\n    );\r\n\r\n    onBeforeMount(() => {\r\n        let locationValue: T;\r\n        if (options.storage && options.storage === \"session\") {\r\n            locationValue = session.getItem(options.name);\r\n        } else {\r\n            locationValue = location.getItem(options.name);\r\n        }\r\n        locationValue !== null && (refValue.value = locationValue);\r\n        options.isWatch &&\r\n            mitter.$on(options.name, (value) => {\r\n                refValue.value = value;\r\n            });\r\n    });\r\n    return refValue;\r\n};\r\n","import { onBeforeMount, onUnmounted, onActivated, onDeactivated } from \"vue\";\r\nimport mitter from \"@/plugins/mitt\";\r\nimport { useRoute } from \"vue-router\";\r\n\r\nexport default (value: () => void) => {\r\n    const route = useRoute();\r\n\r\n    function watchUpdate() {\r\n        mitter.$on(\"update-page\", value);\r\n    }\r\n    onActivated(() => {\r\n        if (route.meta.keepAlive) {\r\n            watchUpdate();\r\n        }\r\n    });\r\n    onDeactivated(() => {\r\n        mitter.$off(\"update-page\", value);\r\n    });\r\n    onBeforeMount(() => {\r\n        if (!route.meta.keepAlive) {\r\n            watchUpdate();\r\n        }\r\n    });\r\n    onUnmounted(() => {\r\n        mitter.$off(\"update-page\", value);\r\n    });\r\n};\r\n","// 手机号正则验证\r\nexport const mobileReg = /^1(3[0-9]|4[5,7]|5[0,1,2,3,5,6,7,8,9]|6[2,5,6,7]|7[0,1,7,8]|8[0-9]|9[1,8,9])\\d{8}$/;\r\n// 身份证正则验证\r\nexport const idCardReg = /^[1-9]\\d{7}((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d{3}$|^[1-9]\\d{5}[1-9]\\d{3}((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d{3}([0-9]|X)$/;\r\n// 超链接正则验证\r\nexport const linkReg = /^https?:\\/\\/(([a-zA-Z0-9_-])+(\\.)?)*(:\\d+)?(\\/((\\.)?(\\?)?=?&?[a-zA-Z0-9_-](\\?)?)*)*$/;\r\n// email正则验证\r\nexport const emailReg = /\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*/;\r\n\r\nexport const checkMobile = (val: string) => mobileReg.test(val);\r\nexport const checkIdCard = (val: string) => idCardReg.test(val);\r\nexport const checkLink = (val: string) => linkReg.test(val);\r\nexport const checkEmail = (val: string) => emailReg.test(val);\r\n\r\n/**\r\n * isObject\r\n * @param value\r\n * @returns\r\n */\r\nexport const isObject = (value: any) => Object.prototype.toString.call(value) === \"[object Object]\";\r\n\r\n/**\r\n * isString\r\n * @param value\r\n * @returns\r\n */\r\nexport const isString = (value: any) => Object.prototype.toString.call(value) === \"[object String]\";\r\n\r\n/**\r\n * isNumber\r\n * @param value\r\n * @returns\r\n */\r\nexport const isNumber = (value: any) => Object.prototype.toString.call(value) === \"[object Number]\";\r\n\r\n/**\r\n * isArray\r\n * @param value\r\n * @returns\r\n */\r\nexport const isArray = (value: any) => Object.prototype.toString.call(value) === \"[object Array]\";\r\n"],"sourceRoot":""}